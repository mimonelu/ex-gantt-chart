(function(e){function t(t){for(var a,s,i=t[0],l=t[1],u=t[2],d=0,f=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&f.push(n[s][0]),n[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],a=!0,i=1;i<r.length;i++){var l=r[i];0!==n[l]&&(a=!1)}a&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={app:0},o=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=l;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"01aa":function(e,t,r){"use strict";r("8e50")},"034f":function(e,t,r){"use strict";r("85ec")},"4cd7":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("h1",[e._v("ExGanttChart")]),r("ExGanttChart",e._b({ref:"exGanttChart",on:{clickBar:e.onClickBar,mouseEnterBar:e.onMouseEnterBar,mouseLeaveBar:e.onMouseLeaveBar}},"ExGanttChart",e.exGanttChartProps,!1)),r("div",{staticClass:"info-container"},[r("pre",[e._v(e._s(JSON.stringify(e.exGanttChartProps)))]),r("pre",[e._v(e._s(e.currentBarInfo))])])],1)},o=[],s=(r("99af"),r("d3b7"),r("a15b"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ex-gantt-chart",attrs:{"data-dragging":e.dragging.toString(),"data-resizing":e.resizing.toString()},on:{mouseup:e.onMouseUp}},[r("table",[r("thead",[r("tr",[e.visibleHeaders?e._l(e.headers,(function(t,a){return r("th",e._b({key:"head-header-"+a,class:t.classes},"th",t.attrs,!1),[r("div",{staticClass:"head-header-label"},[e._v(e._s(t.label))])])})):e._e(),r("td",[r("div",{staticClass:"head-content",style:"grid-template-columns: repeat("+e.dateOfTerm+", 1fr);"},e._l(e.datesInTerm,(function(t,a){return r("div",{key:"date-"+a,staticClass:"date"},[r("div",{staticClass:"separator-label-container",style:"grid-template-columns: repeat("+e.numberOfSubSeparators+", 1fr);"},e._l(e.numberOfSubSeparators,(function(t){return r("div",{key:t,staticClass:"separator-label"},[e._v(e._s((t-1)*e.subSeparatorSpan))])})),0),r("div",{staticClass:"date-label"},[e._v(e._s(e.dateFormatter(t)))])])})),0)])],2)]),r("tbody",e._l(e.body,(function(t,a){return r("tr",{key:"body-row-"+a},[e.visibleHeaders?e._l(t.headers,(function(t,n){return r("th",e._b({key:"body-header-"+a+"-"+n,class:t.classes,style:{display:t.rowSpan?"none":""},attrs:{rowspan:e.rowSpan(a,n)}},"th",t.attrs,!1),[r("div",{staticClass:"body-header-label"},[e._v(e._s(t.label))])])})):e._e(),r("td",e._b({ref:"td-"+a,refInFor:!0,class:t.classes,on:{dragenter:function(e){e.preventDefault()},dragover:function(e){e.preventDefault()},drop:function(t){e.canDrop(a)&&e.onDrop(t,a)},mousemove:e.onMouseMove}},"td",t.attrs,!1),[r("div",{staticClass:"separator-container",style:"grid-template-columns: repeat("+e.dateOfTerm+", 1fr);"},e._l(e.dateOfTerm,(function(t){return r("div",{key:t,staticClass:"main-separator",style:"grid-template-columns: repeat("+e.numberOfSubSeparators+", 1fr);"},e._l(e.numberOfSubSeparators,(function(e){return r("div",{key:e,staticClass:"sub-separator"})})),0)})),0),e._l(t.bars,(function(t,n){return r("div",e._b({key:e.barId(a,n),ref:e.barId(a,n),refInFor:!0,staticClass:"bar",class:t.classes,attrs:{"data-bar-id":e.barId(a,n),"data-visible":e.barVisible(a,n).toString(),draggable:!e.resizing&&e.canDrag(n,a)},on:{dragstart:function(t){!e.resizing&&e.onDragStart(t,a,n)},dragend:e.onDragEnd,click:function(r){return e.$emit("clickBar",{event:r,bar:t,rowIndex:a,barIndex:n,component:e.self})},mouseenter:function(r){return e.$emit("mouseEnterBar",{event:r,bar:t,rowIndex:a,barIndex:n,component:e.self})},mouseleave:function(r){return e.$emit("mouseLeaveBar",{event:r,bar:t,rowIndex:a,barIndex:n,component:e.self})}}},"div",t.attrs,!1),[e.canResize(n,a)?r("div",{staticClass:"bar-handle",on:{mousedown:function(t){return e.onMouseDown(t,a,n,"from")}}}):e._e(),r("div",{staticClass:"bar-content"},[e._v(e._s(t.label))]),e.canResize(n,a)?r("div",{staticClass:"bar-handle",on:{mousedown:function(t){return e.onMouseDown(t,a,n,"to")}}}):e._e()])}))],2)],2)})),0)])])}),i=[],l=r("b85c"),u=(r("a9e3"),r("b64b"),r("caad"),r("2532"),r("a434"),"application/ikzo-bar-index");function c(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)}function d(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)}function f(){var e,t=Object(l["a"])(arguments);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(null!=r)return r}}catch(a){t.e(a)}finally{t.f()}return null}var h={name:"ExGanttChart",props:{from:{type:Date,default:function(){var e=new Date;return e.setDate(e.getDate()-3),c(e)}},to:{type:Date,default:function(){var e=new Date;return e.setDate(e.getDate()+3),d(e)}},headers:{type:Array,required:!0},visibleHeaders:{type:Boolean,default:!0},dateFormatter:{type:Function,default:function(e){return"".concat(e.getDate(),"/").concat(e.getMonth()+1,"/").concat(e.getFullYear())}},body:{type:Array,required:!0},allowParallel:{type:Boolean,default:!0},allowDrag:{type:Boolean,default:!0},allowDrop:{type:Boolean,default:!0},dropToLast:{type:Boolean,default:!0},allowResize:{type:Boolean,default:!0},subSeparatorSpan:{type:Number,default:6}},data:function(){return{dragging:!1,resizing:!1,resizingType:null,resizingBar:null,resizingRowIndex:0}},computed:{self:function(){return this},fromDate:function(){return c(this.from)},toDate:function(){return d(this.to)},fromTime:function(){return this.fromDate.getTime()},toTime:function(){return this.toDate.getTime()},datesInTerm:function(){for(var e=[],t=0;t<this.dateOfTerm;t++){var r=new Date(this.fromDate);r.setDate(r.getDate()+t),e.push(r)}return e},timeOfTerm:function(){return this.toTime-this.fromTime},dateOfTerm:function(){return Math.round(this.timeOfTerm/1e3/60/60/24)},rowSpan:function(){var e=this;return function(t,r){if(e.body[t].headers[r].rowSpan)return null;for(var a=0,n=t+1;n<e.body.length;n++,a++){var o=e.body[n].headers[r];if(void 0===o||!o.rowSpan)break}return 0===a?null:a+1}},barId:function(){return function(e,t){return"bar-".concat(e,"-").concat(t)}},barVisible:function(){var e=this;return function(t,r){var a=e.body[t].bars[r];if(null!=a.visible&&!a.visible)return!1;var n=a.from.getTime(),o=a.to.getTime();return n<=e.toTime&&e.fromTime<=o}},numberOfSubSeparators:function(){return this.subSeparatorSpan>0?Math.floor(24/this.subSeparatorSpan):0}},mounted:function(){this.updateBarsAll()},methods:{updateBarsAll:function(){for(var e=0;e<this.body.length;e++)this.updateBarsInRow(e)},updateBarsInRow:function(e){for(var t=this.body[e].bars,r=0;r<t.length;r++)if(this.barVisible(e,r)){var a=t[r],n=this.barId(e,r),o=this.$el.querySelector('[data-bar-id="'.concat(n,'"]')),s=a.from.getTime(),i=a.to.getTime(),u=(s-this.fromTime)/this.timeOfTerm*100,c=(i-s)/this.timeOfTerm*100;o.style.position="relative",o.style.left="".concat(u,"%"),o.style.width="".concat(c,"%")}if(this.allowParallel){for(var d={},f=0;f<t.length;f++){var h;if(this.barVisible(e,f)){for(var b=t[f],p=b.from.getTime(),m=b.to.getTime(),v=this.barId(e,f),g=this.$el.querySelector('[data-bar-id="'.concat(v,'"]')),y=0,w=0;w<f;w++)if(this.barVisible(e,w)){var D=t[w],T=D.from.getTime(),S=D.to.getTime();if(T<=m&&p<=S){var x=this.barId(e,w),I=this.$el.querySelector('[data-bar-id="'.concat(x,'"]')),_=I.offsetTop+I.offsetHeight;y=Math.max(y,_)}}for(var O=Object.keys(d),z=0,B=O;z<B.length;z++){var M,C=B[z],k=!1,j=Object(l["a"])(d[C]);try{for(j.s();!(M=j.n()).done;){var R=M.value,E=R.from.getTime(),H=R.to.getTime();if(E<=m&&p<=H){k=!0;break}}}catch(A){j.e(A)}finally{j.f()}if(!1===k){y=C;break}}g.style.position="absolute",g.style.top="".concat(y,"px"),d[y]=null!==(h=d[y])&&void 0!==h?h:[],d[y].push(b)}}for(var P=0,$=0;$<t.length;$++)if(this.barVisible(e,$)){var F=this.barId(e,$),G=this.$el.querySelector('[data-bar-id="'.concat(F,'"]')),L=G.offsetTop+G.offsetHeight;P=Math.max(P,L)}this.$refs["td-".concat(e)][0].style.height="".concat(P,"px")}},canDrag:function(e,t){var r,a,n;return f(null===(r=this.body[t])||void 0===r||null===(a=r.bars[e])||void 0===a?void 0:a.allowDrag,null===(n=this.body[t])||void 0===n?void 0:n.allowDrag,this.allowDrag)},canDrop:function(e){var t;return f(null===(t=this.body[e])||void 0===t?void 0:t.allowDrop,this.allowDrop)},onDragStart:function(e,t,r){this.dragging=!0,e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData(u,JSON.stringify({rowIndex:t,barIndex:r,offset:e.offsetX}))},onDragEnd:function(){this.dragging=!1},onDrop:function(e,t){if(e.dataTransfer.types.includes(u)){var r,a;e.preventDefault();var n=e.dataTransfer.getData(u),o=JSON.parse(n),s=this.body[o.rowIndex].bars[o.barIndex],i=e.offsetX,l=e.target;while(null!=l&&"TD"!==l.tagName)i+=l.offsetLeft,l=l.parentNode;var c=null!==(r=null===(a=l)||void 0===a?void 0:a.offsetWidth)&&void 0!==r?r:0,d=(i-o.offset)/c,f=this.timeOfTerm*d+this.fromTime,h=s.to.getTime()-s.from.getTime()+f;s.from.setTime(f),s.to.setTime(h),t!==o.rowIndex&&(this.dropToLast?this.body[t].bars.push(s):this.body[t].bars.unshift(s),this.body[o.rowIndex].bars.splice(o.barIndex,1)),this.$nextTick(this.updateBarsAll)}},canResize:function(e,t){var r,a,n;return f(null===(r=this.body[t])||void 0===r||null===(a=r.bars[e])||void 0===a?void 0:a.allowResize,null===(n=this.body[t])||void 0===n?void 0:n.allowResize,this.allowResize)},onMouseDown:function(e,t,r,a){this.canResize(r,t)&&(this.resizing=!0,this.resizingType=a,this.resizingBar=this.body[t].bars[r],this.resizingRowIndex=t)},onMouseMove:function(e){if(this.resizing){var t=e.offsetX,r=this.$refs["td-".concat(this.resizingRowIndex)][0].offsetWidth,a=this.fromTime+t/r*this.timeOfTerm,n=this.resizingBar[this.resizingType],o="from"===this.resizingType?this.resizingBar.to.getTime()-a:a-this.resizingBar.from.getTime(),s=this.timeOfTerm/100;o>=s&&(n.setTime(a),this.updateBarsInRow(this.resizingRowIndex))}},onMouseUp:function(){this.resizing&&(this.resizing=!1,this.resizingType=null,this.resizingBar=null,this.resizingRowIndex=0)}}},b=h,p=(r("a8d4"),r("01aa"),r("2877")),m=Object(p["a"])(b,s,i,!1,null,"6cd1483c",null),v=m.exports,g=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},y=function(e){e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)},w=function(e){e.setHours(23),e.setMinutes(59),e.setSeconds(59),e.setMilliseconds(999)},D={name:"App",components:{ExGanttChart:v},data:function(){return{exGanttChartProps:this.makeData(7),currentBarInfo:""}},methods:{makeData:function(e){var t=new Date;y(t);var r=new Date;r.setDate(t.getDate()+(e-1)),w(r);for(var a=[],n=0;n<3;n++){var o=[{label:"Body header 1",classes:{"custom-body-header-class-1":!0},attrs:{"data-custom-body-header-attr-1":!0}},{label:"Body header 2",classes:{"custom-body-header-class-2":!0},attrs:{"data-custom-body-header-attr-2":!0}}];n>=1&&(o[0]={rowSpan:!0});for(var s=[],i=0;i<n*(n+1)+1;i++){var l=new Date(t);l.setHours(g(-6,24*e-1));var u=new Date(l);u.setHours(u.getHours()+g(6,48)),s.push({from:l,to:u,label:"Bar ".concat(n+1,"-").concat(i+1),classes:{"custom-bar-class":!0},attrs:{"data-custom-bar-attr":!0},visible:!0,allowDrag:!0,allowResize:!0})}a.push({headers:o,bars:s,classes:{"custom-body-content-class":!0},attrs:{"data-custom-body-content-attr":!0},allowDrag:!0,allowDrop:!0,allowResize:!0})}var c={from:t,to:r,headers:[{label:"Head header 1",classes:{"custom-head-header-class-1":!0},attrs:{"data-custom-head-header-attr-1":!0}},{label:"Head header 2",classes:{"custom-head-header-class-2":!0},attrs:{"data-custom-head-header-attr-2":!0}}],visibleHeaders:!0,dateFormatter:function(e){var t=["日","月","火","水","木","金","土"];return"".concat(e.getMonth()+1,"/").concat(e.getDate()," (").concat(t[e.getDay()],")")},body:a,allowParallel:!0,allowDrag:!0,allowDrop:!0,dropToLast:!0,allowResize:!0,subSeparatorSpan:6};return c},onClickBar:function(e){e.event;var t=e.bar,r=e.rowIndex,a=(e.barIndex,e.component),n=[];for(var o in t){var s="[object Date]"===Object.prototype.toString.call(t[o])?new Date(t[o]).toLocaleString():"[object Object]"===Object.prototype.toString.call(t[o])?JSON.stringify(t[o]):t[o];n.push("".concat(o,": ").concat(s))}this.currentBarInfo=n.join("\n"),y(t.from),w(t.to),a.updateBarsInRow(r)},onMouseEnterBar:function(e){e.event,e.bar,e.rowIndex,e.barIndex,e.component},onMouseLeaveBar:function(e){e.event,e.bar,e.rowIndex,e.barIndex,e.component}}},T=D,S=(r("034f"),Object(p["a"])(T,n,o,!1,null,null,null)),x=S.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(x)}}).$mount("#app")},"85ec":function(e,t,r){},"8e50":function(e,t,r){},a8d4:function(e,t,r){"use strict";r("4cd7")}});
//# sourceMappingURL=app.e73facf8.js.map